Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"unsortedOverlay", "[", 
    RowBox[{"h1_", ",", "h2_"}], "]"}], ":=", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"h1", ",", "h2"}], "]"}], ",", 
     RowBox[{"Intersection", "[", 
      RowBox[{"h1", ",", "h2"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"overlay", "[", 
    RowBox[{"h1_", ",", "h2_"}], "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{"unsortedOverlay", "[", 
     RowBox[{"h1", ",", "h2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"overlay", "[", 
     RowBox[{"h1_", ",", "h2_", ",", "ho__"}], "]"}], ":=", 
    RowBox[{"overlay", "[", 
     RowBox[{
      RowBox[{"overlay", "[", 
       RowBox[{"h1", ",", "h2"}], "]"}], ",", "ho"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"delete", "[", 
    RowBox[{"h_", ",", "qubit_"}], "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{"h", ",", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"MemberQ", "[", 
        RowBox[{"#", ",", "qubit"}], "]"}]}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"projection", "[", 
    RowBox[{"h_", ",", "qubit_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{"#", ",", "qubit"}], "]"}], "&"}], " ", "/@", " ", 
    RowBox[{"Select", "[", 
     RowBox[{"h", ",", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"#", ",", "qubit"}], "]"}], "&"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unsortedShrink", "[", 
    RowBox[{"h_", ",", "qubit_"}], "]"}], ":=", 
   RowBox[{"unsortedOverlay", "[", 
    RowBox[{
     RowBox[{"delete", "[", 
      RowBox[{"h", ",", "qubit"}], "]"}], ",", 
     RowBox[{"projection", "[", 
      RowBox[{"h", ",", "qubit"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"shrink", "[", 
     RowBox[{"h_", ",", "qubit_"}], "]"}], ":=", 
    RowBox[{"overlay", "[", 
     RowBox[{
      RowBox[{"delete", "[", 
       RowBox[{"h", ",", "qubit"}], "]"}], ",", 
      RowBox[{"projection", "[", 
       RowBox[{"h", ",", "qubit"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"compactify", "[", 
     RowBox[{"h_", ",", "qubit_", ",", "numQubits_"}], "]"}], ":=", 
    RowBox[{"h", "/.", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"qubit", "+", "1"}], ",", "numQubits"}], "}"}]}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"compactDelete", "[", 
    RowBox[{"h_", ",", "qubit_", ",", "numQubits_"}], "]"}], ":=", 
   RowBox[{"compactify", "[", 
    RowBox[{
     RowBox[{"delete", "[", 
      RowBox[{"h", ",", "qubit"}], "]"}], ",", "qubit", ",", "numQubits"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"compactProjection", "[", 
    RowBox[{"h_", ",", "qubit_", ",", "numQubits_"}], "]"}], ":=", 
   RowBox[{"compactify", "[", 
    RowBox[{
     RowBox[{"projection", "[", 
      RowBox[{"h", ",", "qubit"}], "]"}], ",", "qubit", ",", "numQubits"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"compactShrink", "[", 
     RowBox[{"h_", ",", "qubit_", ",", "numQubits_"}], "]"}], ":=", 
    RowBox[{"compactify", "[", 
     RowBox[{
      RowBox[{"shrink", "[", 
       RowBox[{"h", ",", "qubit"}], "]"}], ",", "qubit", ",", "numQubits"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"memThreshold", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"memWeight", "[", 
     RowBox[{"h_", ",", "numQubits_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"memWeight", "[", 
      RowBox[{"h", ",", "numQubits"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"numQubits", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"1", " ", "-", " ", 
        RowBox[{"2", " ", 
         RowBox[{"Boole", "[", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"h", ",", 
            RowBox[{"{", "}"}]}], "]"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"d", "=", 
            RowBox[{"delete", "[", 
             RowBox[{"h", ",", "numQubits"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"s", "=", 
            RowBox[{"unsortedShrink", "[", 
             RowBox[{"h", ",", "numQubits"}], "]"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"memWeight", "[", 
           RowBox[{"d", ",", 
            RowBox[{"numQubits", "-", "1"}]}], "]"}], "+", 
          RowBox[{"memWeight", "[", 
           RowBox[{"s", ",", 
            RowBox[{"numQubits", "-", "1"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"weight", "[", 
     RowBox[{"h_", ",", "numQubits_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"numQubits", "\[LessEqual]", "memThreshold"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"memWeight", "[", 
       RowBox[{"h", ",", "numQubits"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"d", "=", 
           RowBox[{"delete", "[", 
            RowBox[{"h", ",", "numQubits"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"s", "=", 
           RowBox[{"unsortedShrink", "[", 
            RowBox[{"h", ",", "numQubits"}], "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"weight", "[", 
          RowBox[{"d", ",", 
           RowBox[{"numQubits", "-", "1"}]}], "]"}], "+", 
         RowBox[{"weight", "[", 
          RowBox[{"s", ",", 
           RowBox[{"numQubits", "-", "1"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"isOrthogonal", "[", 
    RowBox[{"h_", ",", "numQubits_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"weight", "[", 
     RowBox[{"h", ",", "numQubits"}], "]"}], "\[Equal]", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"areOrthogonal", "[", 
     RowBox[{"h1_", ",", "h2_", ",", "numQubits_"}], "]"}], ":=", " ", 
    RowBox[{"isOrthogonal", "[", 
     RowBox[{
      RowBox[{"overlay", "[", 
       RowBox[{"h1", ",", "h2"}], "]"}], ",", "numQubits"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PermuteVertices", "[", 
     RowBox[{"h_", ",", "permutation_", ",", "numQubits_"}], "]"}], ":=", 
    RowBox[{"Sort", "[", 
     RowBox[{"Sort", "/@", 
      RowBox[{"(", 
       RowBox[{"h", "/.", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"k", "\[Rule]", 
           RowBox[{"permutation", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "numQubits"}], "}"}]}], "]"}]}], ")"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"degree", "[", 
    RowBox[{"h_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Length", "[", 
    RowBox[{"projection", "[", 
     RowBox[{"h", ",", "i"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"degreeSequence", "[", 
    RowBox[{"h_", ",", "numQubits_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"degree", "[", 
      RowBox[{"h", ",", "i"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "numQubits"}], "}"}]}], "]"}]}], ";"}]}], "Input"]
},
WindowSize->{1225, 756},
WindowMargins->{{-2, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
TrackCellChangeTimes->False,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb",
PrivateNotebookOptions -> {
 "VersionedStylesheet" -> {"Default.nb"[8.] -> False}}
]

